# %% [code]

---
title: "Bellabeat Case Study"
author: "Elizabeth Gels"
date: "2023-03-03"
output:
  html_document:
    number_sections: true
    toc: true
    toc_depth: 3
    theme: default
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ABOUT THE COMPANY

Bellabeat is a high-tech manufacturer of health-focused products for women. Collecting data on activity, sleep, stress, and reproductive health has allowed Bellabeat to empower women with knowledge about their own health and habits. Since it was founded in 2013, Bellabeat has grown rapidly and quickly positioned itself as a tech-driven wellness company for women.

By 2016, Bellabeat had opened offices around the world and launched multiple products. Bellabeat products became available through a growing number of online retailers in addition to their own e-commerce channel on their website. The company has invested in traditional advertising media, but focuses on digital marketing extensively.

Bellabeat products:

* Bellabeat app: It provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions.

* Time: This wellness watch combines the timeless look of a classic timepiece with smart technology to track user activity, sleep, and stress. The Time watch connects to the Bellabeat app to provide you with insights into your daily wellness.

# ASK

## Business Task

Bellabeat is a successful small company, but they have the potential to become a larger player in the global smart device market. Urška Sršen, Bellabeat's co-founder and Chief Creative Officer, believes that analyzing smart device fitness data could help unlock new opportunities for the company.

Working as a data analyst in the marketing analytics team, I will analyze FitBit's users data to gain insight into how consumers are using their smart devices. Then, based on the insights discovered I will provide high-level recommendations for Bellabeat's marketing strategy. 

# PREPARE

## Data Set

The FitBit Fitness Tracker Data is Public Domain and was made available by users on Kaggle. Click here ([link](https://www.kaggle.com/datasets/arashnic/fitbit)) to view the data set. 

The data set contains information on FitBit fitness tracker usage, collected from 33 eligible FitBit users who consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. 

These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 04/12/2016 and 05/12/2016. Amazon Mechanical Turk is part of Amazon.com, and they offer online crowdsourcing tools for conducting research.  

## Analytical Tool

The tool chosen for this analysis is R programming, used in the platform of Rstudio Cloud.  

# PROCESS AND ANALYSIS

## Loading R Packages

```{r echo=TRUE, message=FALSE, warning=FALSE}
install.packages("tidyverse")
library(tidyverse)

install.packages("dplyr")
library(dplyr)

install.packages("lubridate")
library(lubridate)

install.packages("readr")
library(readr)

install.packages("skimr")
library(skimr)
```

## Daily Activity Data

Loading the daily_Activity file:

```{r echo=TRUE, message=FALSE, warning=FALSE}
Daily_Activity <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
```

Looking at the structure of the table:

```{r echo=TRUE, message=FALSE, warning=FALSE}
str(Daily_Activity)
```

The variables are: Id (User's Unique Identifier), Activity Date (in MM/DD/YYYY format), Total Steps and Calories burned.

FitBit tracks Minutes and Distance (Km) by Intensity levels: Sedentary, Lightly Active, Fairly (Moderately) Active and Very Active. However, there’s no proper or technical definitions for these levels. Based on information by the Harvard T.H. Chan, School of Public Health [link](https://www.hsph.harvard.edu/nutritionsource/staying-active/), we assumed that the intensities used in this sample correspond to the following examples: 

* Sedentary: Sitting, reclining, or lying down.
* Light intensity: Walking at a leisurely pace or standing in line at the store.
* Moderate (Fairly) intensity: Walking briskly, vacuuming, or raking leaves.
* Vigorous (Very Active): Walking very quickly, running, taking an aerobics class, or shoveling snow.

No duplicates were found:

```{r echo=TRUE, message=FALSE, warning=FALSE}
nrow(Daily_Activity[duplicated(Daily_Activity), ])
```

Changing the data type for variable ActivityDate (from character to date) by creating a new column:

```{r echo=TRUE}
Daily_Activity$ActivityDate_New <- mdy(Daily_Activity$ActivityDate)
```

By counting unique values, we confirm we have 33 unique users, 31 days and 940 observations: 

```{r echo=TRUE}
n_distinct(Daily_Activity$Id)

n_distinct(Daily_Activity$ActivityDate_New)

nrow(Daily_Activity)
```

Looking at data stats:

```{r}
Daily_Activity %>%  
  summary()
```

Transforming the data by creating a new table Daily_Activity_AddedColumns. We add the following new columns to Daily_Activity: Sum of total minutes, minutes to hours conversion, percentages of time by activity and days of the week.

```{r}
Daily_Activity_AddedColumns <- Daily_Activity %>%
  mutate(totalminutes=(SedentaryMinutes + LightlyActiveMinutes + FairlyActiveMinutes + VeryActiveMinutes),
         hoursaday=(totalminutes/60), Percentageused=((hoursaday/24)*100), 
         veryactiveminutesp=((VeryActiveMinutes/totalminutes)*100),
         fairlyactiveminutesp=((FairlyActiveMinutes/totalminutes)*100),
         lightlyactiveminutesp=((LightlyActiveMinutes/totalminutes)*100),
         sedentaryminutesp=((SedentaryMinutes/totalminutes)*100),
         dayofweek=weekdays(ActivityDate_New))
```

### Minutes of Daily Activity

Total Minutes stats:

Median: 1,440.0 minutes (24 hours)  
Mean: 1,218.8 minutes (20.3 hours)

From the start, these stats seem high when considering that sleep hours haven't been accounted for.

Transforming the data to calculate averages for Minutes and Distance.

```{r}
Daily_Activity_AddedColumns2 <- Daily_Activity_AddedColumns %>%
  group_by(dayofweek) %>%
  summarise(avgveryactivemin=mean(VeryActiveMinutes),
         avgfairlyactivemin=mean(FairlyActiveMinutes),
         avglightlyactivemin=mean(LightlyActiveMinutes),
         avgsedentarymin=mean(SedentaryMinutes),
         avgveryactivedis=mean(VeryActiveDistance),
         avgfairlyactivedis=mean(ModeratelyActiveDistance),
         avglightlyactivedis=mean(LightActiveDistance),
         avgsedentarydis=mean(SedentaryActiveDistance))
```

Pivoting previous table:

```{r}
dtav <- gather(Daily_Activity_AddedColumns2, key="typeofActivity", value="Average", 2:9)
```

Creating graph: 

```{r}
dtav$dayofweek <- ordered(dtav$dayofweek, levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", 
     "Saturday", "Sunday"))

ggplot(dtav[1:28, ], aes(x=typeofActivity, y=Average, fill=typeofActivity)) + 
    geom_bar(stat="identity") +
    labs(x="", y="Average Minutes", title="Average Minutes by Activity Type and Day of the Week") +
    geom_text(aes(label=round(Average)), position=position_dodge(width=0.9), vjust=-0.25, size=2.5) +
    scale_x_discrete(labels=c("Fairly", "Lightly", "Sedentary", "Very Active")) + 
    theme(axis.text.x = element_text(angle=45), legend.position="right") +
    scale_fill_manual(values=c("#E69F00", "#458B00", "#56B4E9", "#EE3B3B"), name="",
    labels=c("Fairly", "Lightly", "Sedentary", "Very Active")) + 
    facet_wrap(~dayofweek) 
```

There is small variation in the averages of time per activity across the days of the week. 

* Average of Lightly Active Minutes slightly increase on Fridays and Saturdays

* Average of Fairly Active Minutes slightly increase on Saturdays and Sundays.

* Average of Very Active Minutes slightly increase on Mondays and Tuesdays.

The pattern seems to indicate that people tend to exercise vigorously (Very Active) during the first days of the week (Monday, Tuesdays, Wednesday), and have more Light and Fairly activity minutes during the weekend. This could be related to weekend activities such as doing groceries or cleaning. 

### Sedentary Minutes

As a group, users spent an average of 80% of their daily time in sedentary activities. This percentage seems large, therefore we look into this variable a little closer:

* Mean: 991.2 minutes (15.5 hours)
* Median: 1,057.5 minutes (17.6 hours)

To produce a graph, we create a data frame that shows users' average percentage of time per activity. 

```{r}
category <- c("average_veryactive", "average_fairlyactive", "average_lightlyactive", "average_sedentary") 
percentages <- c(1.84, 1.20, 16.98, 79.98)

summary_average_minutes <- data.frame(category, percentages)
```

```{r}
ggplot(summary_average_minutes, aes(x=" ", y=percentages, fill=category)) + 
    geom_bar(stat="identity", width=1) + coord_polar(theta = "y") +
    geom_text(aes(label = scales::percent(percentages/100)), position = position_stack(vjust = 0.4),
    size = 3, check_overlap= TRUE)  +
    labs(x = " ", y = " ", title = "Average Percentage of Daily Time by Activity Type") + 
    scale_fill_discrete(name = "Activity Type", 
    labels = c("Fairly Active", "Lighlty Active", "Sedentary", "Very Active")) +
    theme_void()
```

While in average, 80% of total minutes was spent as Sedentary, 17% was considered Lightly Active and roughly 3% was both Fairly and Very Active time.

```{r}
Daily_Activity_AddedColumnssm <- Daily_Activity_AddedColumns %>% group_by(Id )%>% 
    summarise(SedentaryHoursperId=(mean(SedentaryMinutes))/60)

ggplot(Daily_Activity_AddedColumnssm, aes(x=Id, y=SedentaryHoursperId)) + geom_point() +
    labs(x="User Id", y="Sedentary Hours per Day", title="Sedentary Hours by User") 
```

When plotting Sedentary hours per user Id, we seem to find two groups:

* 14 users (42%) have Sedentary times between 11 and 15 hours.
* 19 users (58%) have Sedentary times between 17 and 22 hours.

Studies suggest that typical adult Sedentary time is around. 9.5 hours a day. Considering that one day has 24 hours, it seems that Sedentary Minutes were largely overestimated when collecting the data.

### Distance (Km) of Daily Activity 

The average person walks roughly 1.5 to 2 miles. Looking at the mean for total Distance (3.41 miles), most users seem to be doing better than average but still below the recommended distance of 5 miles (10,000 steps) a day.

* Median: 5.245 km (3.26 miles)
* Mean: 5.490 km (3.41 miles)

Users in average recorded 71% of their total daily distance as Light Distance, 9% was Moderately (Fairly) Distance and 19% was Very Active Distance. Just as with Sedentary Minutes being almost 80% of the total time, for the most part people tend to be sedentary, and to walk mostly for light activities during the day.

```{r}

ggplot(dtav[29:56, ], aes(x=typeofActivity, y=Average, fill=typeofActivity)) + geom_bar(stat="identity") +
    labs(x="", y="Average Distance (Km)", title="Average Distance by Activity Type and Day of the Week") +
    geom_text(aes(label=round(Average, 2)), position=position_dodge(width=0.9), vjust=-0.25, size=2.5) +
    scale_x_discrete(labels=c("Fairly", "Lightly", "Sedentary", "Very Active")) + 
    theme(axis.text.x = element_text(angle=45), legend.position="right") +
    scale_fill_manual(values=c("#E69F00", "#458B00", "#56B4E9", "#EE3B3B"), name="",
    labels=c("Fairly Active", "Lightly Active", "Sedentary", "Very Active")) + 
    facet_wrap(~dayofweek) 
```

Just as with time, there is small variation in the averages of distance per activity across the days of the week. 

* Average of Light Active Distance peaks on Saturday.

* Average of Fairly Active Distance peaks on Saturday and Sunday.

* Average of Very Active Distance peaks on Tuesday and Wednesday.

This pattern is consistent with what we found when looking at Minutes of Activity per day of the week. Very Active Distance is related to the first days of the week, while Fair and Light Active Distance tend to happen during weekends.

### Steps

Most respondents (26 users, 79% of total) are below the recommended number of 10,000 steps a day.

* Median: 7,406 steps (3.51 miles)
* Mean: 7,638 steps (3.62 miles)

```{r}
ggplot(Daily_Activity_AddedColumns) +
  aes(x = "", y = TotalSteps) +
  xlab(" ") +
  ylab("Steps") +  
  ggtitle("Total Steps Box Plot") +
  theme_minimal() +
  geom_boxplot(fill = "#0c4c8a") 
```

```{r}
Daily_Activity_AddedColumns3 <- Daily_Activity_AddedColumns %>%
  group_by(dayofweek) %>%
  summarise(avgsteps=mean(TotalSteps))
```

```{r}
Daily_Activity_AddedColumns3$dayofweek <- ordered(Daily_Activity_AddedColumns3$dayofweek, 
    levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

ggplot(data=Daily_Activity_AddedColumns3, aes(x=dayofweek, y=avgsteps)) + labs(x="Day of the Week", 
    y="Average Steps per Day", title="Average Steps by Day of the Week") + 
    geom_bar(fill="#0c4c8a", stat="identity")
```

* Surprisingly the most Steps are taken on Saturdays, this might be related to a slight increase in Lightly and Fairly Active Distances for that day. 

* Tuesday has the second highest number of Steps taken. This is consistent with a slight increase on Very Active Distance for that day.

* Sunday has the least amount of Steps taken which might reflect that Lightly Active Distance is the lowest on this day as well.

As notice before this pattern seems to indicate that Steps on Tuesdays are linked to more intense exercise, while weekends seemed to be linked to lighter intensity activities. Most people tend to do errands, groceries or cleaning during weekends. 

### Calories 

The recommended daily calorie intake is around 2,500 calories for men and 2,000 calories for women. In average, more than half of the users in this sample fall within a 1,800 to 2,700 calorie range.

* Median: 2,134 calories
* Mean: 2,304 calories

```{r}
ggplot(Daily_Activity_AddedColumns) +
  aes(x = "", y = Calories) +
  xlab(" ") +
  ylab("Calories") +  
  ggtitle("Calories Box Plot") +
  theme_minimal() +
  geom_boxplot(fill = "#0c4c8a") 
```

## Sleep Data

Loading the sleepDay file:

```{r}
Sleep_Day <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
```

Only 24 participants recorded sleep hours:

```{r}
n_distinct(Sleep_Day$Id)

nrow(Sleep_Day)
```

Looking at data stats:

```{r}
  Sleep_Day %>%
  summary()
```

Changing data type for variable Sleepday (from character to date) by creating a new column:

```{r}
Sleep_Day$SleepDay_New <- mdy_hms(Sleep_Day$SleepDay)
```

Three duplicates were found:

```{r}
nrow(Sleep_Day[duplicated(Sleep_Day), ])
```

Getting rid of duplicates:

```{r}
Sleep_Day2 <- Sleep_Day %>% distinct()

nrow(Sleep_Day2)
```

Merging tables Daily_Activity and Sleep_Day2:

```{r}
df <- rename(Sleep_Day2,"ActivityDate_New"="SleepDay_New")

combined_data <- merge(df, Daily_Activity, by=c("Id","ActivityDate_New"))
```

We still have 24 respondents but 410 observations:

```{r}
n_distinct(combined_data$Id)

nrow(combined_data)
```

By merging Daily Activity and Sleep data, the sample has been reduced from 33 to 24 users. The sample is too small to draw any accurate conclusions.

### Minutes Asleep

The recommended number of sleep hours for adults is between 7 to 9 hours a day. 10 respondents (42%) sleep within the recommended range. 

* Median: 433 minutes (7.22 hours)
* Mean: 419 minutes (7 hours)

```{r}
ggplot(combined_data) +
  aes(x = "", y = TotalMinutesAsleep) +
  xlab(" ") +
  ylab("Minutes Asleep") +  
  ggtitle("Minutes Asleep Box Plot") +
  theme_minimal() +
  geom_boxplot(fill = "#0c4c8a") 
```

We found a positive correlation between TotalTimeInBed and TotalMinutesAsleep. This makes sense, and in average the difference between these two variables was 38.4 minutes.

### Fitbit Daily Usage

We assumed the following definition:

FitBit's Daily Usage = Sedentary Minutes + Lightly Active Minutes + Fairly Active Minutes + Very Active Minutes + Sleep Time

To calculate the average number of hours users worn the tracker in a day, we run the following code:

```{r message=FALSE, warning=FALSE}

Daily_Activity_AddedColumns_Usage <- combined_data %>% 
    group_by(Id, ActivityDate_New) %>% 
    summarise(UsageTotalTime=(TotalTimeInBed + SedentaryMinutes + LightlyActiveMinutes +  FairlyActiveMinutes + VeryActiveMinutes),  
    UsageHours=UsageTotalTime/60)
          
Daily_Activity_AddedColumns_Usage_t <- Daily_Activity_AddedColumns_Usage %>% 
    group_by(Id) %>% summarise(AveUsageTotalTimeperId=(mean(UsageTotalTime)/60))

Daily_Activity_AddedColumns_Usage_t2 <- Daily_Activity_AddedColumns_Usage_t %>% 
    mutate(Uselevel=if_else(AveUsageTotalTimeperId<24, "23 to less than 24 hours",
    (if_else(AveUsageTotalTimeperId<=24, "24 hours", "Over 24 hours to 26 hours"))))

ggplot(Daily_Activity_AddedColumns_Usage_t2, aes(x=Uselevel)) + geom_bar(fill="#0c4c8a") + 
    labs(x="", y="Number of Users", title="Repondents by Usage Level")
```

All respondents used their trackers between 23 and 26 hours per day. 17 respondents (71%) used the tracker between 23 and 24 hours a day. Anything over 24 hours doesn't make sense, it looks like a mistake was made when collecting the data. 

Trying to analyze people by dividing them in groups by usage level wouldn't work because the sample sizes are too small; and it would get even worse if we get rid of the observations that have over 24 hours of usage per day.

### Correlations 

```{r message=FALSE, warning=FALSE}
                       
ggplot(data=Daily_Activity, aes(x=TotalSteps, y=SedentaryMinutes)) + geom_point() + geom_smooth(method=lm) +
  labs(x="Steps", y="Sedentary Minutes", title="Steps and Sedentary Minutes")
```

* Steps and Sedentary Minutes show a negative relationship. Although it seems obvious, it validates the notion that tracking steps leads to a healthier lifestyle. 

```{r message=FALSE, warning=FALSE}
                       
ggplot(combined_data, aes(x=TotalMinutesAsleep, y=SedentaryMinutes)) + geom_point() + geom_smooth(method=lm) +
  labs(x="Minutes Asleep", y="Sedentary Minutes", title="Minutes Asleep vs. Sedentary Minutes")
```

* Minutes Asleep and Sedentary Minutes show a negative relationship. Sedentary time doesn't lead to a healthy lifestyle, and more sedentary time is related to less sleep.

```{r message=FALSE, warning=FALSE}

ggplot(data=Daily_Activity, aes(x=TotalSteps, y=Calories)) + geom_point() + geom_smooth(method=lm) + 
    labs(x="Steps", y="Calories", title="Steps vs. Calories")
```

* As expected, Steps and Calories show a positive relationship.

Doing more analysis we found that:

* As expected, both Steps and Calories tend to have a positive relationship with Minutes and Distance at all their intensity levels.  

* No clear relationship was found between Minutes Asleep and Calories; and Minutes Asleep vs. Minutes and Distances.
      
## Hourly Data

Loading the hourly data:

```{r echo=TRUE, message=FALSE, warning=FALSE}
hourlyCalories <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv")

hourlyIntensities <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv")

hourlySteps <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
```

Looking at the structure of the tables:

```{r echo=TRUE, message=FALSE, warning=FALSE}
str(hourlyCalories)

str(hourlyIntensities)

str(hourlySteps)
```

Looking at data stats: 

```{r echo=TRUE, message=FALSE, warning=FALSE}
summary(hourlyCalories)

summary(hourlyIntensities)

summary(hourlySteps)
```

No duplicates were found:

```{r echo=TRUE, message=FALSE, warning=FALSE}
nrow(hourlyCalories[duplicated(hourlyCalories), ])

nrow(hourlyIntensities[duplicated(hourlyIntensities), ])

nrow(hourlySteps [duplicated(hourlySteps ), ])
```

Changing data type for variable ActivityHour (from character to date) by creating a new column:

```{r echo=TRUE, message=FALSE, warning=FALSE}
hourlyCalories$ActivityHour_New <- mdy_hms(hourlyCalories$ActivityHour)

hourlyIntensities$ActivityHour_New <- mdy_hms(hourlyIntensities$ActivityHour)

hourlySteps$ActivityHour_New <- mdy_hms(hourlySteps$ActivityHour)
```

Merging hourly tables (hourlyCalories, hourlyIntensities and hourlySteps):

```{r echo=TRUE, message=FALSE, warning=FALSE}
combined_hourly_temp <- merge(hourlyCalories,hourlyIntensities,by=c("Id","ActivityHour_New"))

combined_hourly <- merge(combined_hourly_temp, hourlySteps, by=c("Id","ActivityHour_New"))
```

Changing data type for variable ActivityHour to include hours of the day:

```{r echo=TRUE, message=FALSE, warning=FALSE}
    combined_hourly_h <- combined_hourly %>% 
    mutate(Hours=format(as.POSIXct(hourlySteps$ActivityHour_New), format = "%H"), dayofweek=weekdays(ActivityHour_New))
```

We found 33 unique users, the same number as the Daily_Activity data:

```{r echo=TRUE, message=FALSE, warning=FALSE}
n_distinct(combined_hourly$Id)
```

### Hourly Trends

To graph data by day of the week and by hour of the day:

```{r echo=TRUE, message=FALSE, warning=FALSE}

combined_hourly_h1 <- combined_hourly_h %>% group_by(dayofweek, Hours) %>%
    summarise(avesteps=mean(StepTotal), avecal=mean(Calories), aveintensity=mean(AverageIntensity))
```

```{r echo=TRUE, message=FALSE, warning=FALSE}

combined_hourly_h1$dayofweek <- ordered(combined_hourly_h1$dayofweek, levels=c("Monday", "Tuesday",
    "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

ggplot(data=combined_hourly_h1, aes(x=Hours, y=avesteps)) + labs(x="Hours of the Day", y="Average Steps", 
    title= "Average Steps by Day of the Week and Hours of the Day") + geom_bar(stat="identity", fill="#0c4c8a") +
    facet_wrap(~dayofweek) + theme(axis.text.x = element_text(angle = 45, size=5, color="#708090"))  
```

* From Monday through Friday steps peak between 5pm to 7pm.

* On Tuesdays and Thursdays steps increase around launch time as well.

* On Saturdays there is a peak between 12pm and 2pm.

* Respondents seem to follow a typical working schedule (9am to 5pm).

* They tend to increase their step count right after work and around launch time.

```{r}
ggplot(data=combined_hourly_h1, aes(x=Hours, y=avecal)) + labs(x="Hours of the Day", y="Calories",
  title= "Average Calories by Day of the Week and Hours of the Day")  +                                                         
  geom_bar(stat="identity", fill="#0c4c8a") + facet_wrap(~dayofweek) +
  theme(axis.text.x = element_text(angle = 45, size=5, color="#708090"))  
```

Average Calories burned follow the same hourly pattern as Steps.

```{r}
ggplot(data=combined_hourly_h1, aes(x=Hours, y=aveintensity)) + labs(x="Hours of the Day", y="Average Intensity",
  title= "Average Intensity by Day of the Week and Hours of the Day")  +  
  geom_bar(stat="identity", fill="#0c4c8a") + facet_wrap(~dayofweek) +
  theme(axis.text.x = element_text(angle = 45, size=5, color="#708090"))  
```

From the data dictionary document ([link](https://www.fitabase.com/media/1930/fitabasedatadictionary102320.pdf)), Intensity values are defined as: 0 = Sedentary, 1 = Light, 2 = Moderate and 3 = Very Active. We assume these Intensity values correspond to the activity types defined for Minutes and Distance. 

Average Intensity follows the same hourly pattern as Steps and Calories.

### Correlations 

```{r echo=TRUE, message=FALSE, warning=FALSE}
ggplot(data=combined_hourly, aes(x=StepTotal, y=Calories)) + geom_point() + geom_smooth(method=lm) +
  labs(x="Steps", y="Calories", title="Steps vs. Calories")
```

* Positive relationship found between Steps taken and Calories burned, same result as in the daily data.

```{r echo=TRUE, message=FALSE, warning=FALSE}
ggplot(data=combined_hourly, aes(x=Calories, y=AverageIntensity)) + geom_point() + geom_smooth(method=lm) +
  labs(x="Calories", y="Average Intensity", title="Calories vs. Average Intensity")
```

* Average Intensity and Calories burned show to have a positive relationship.

```{r echo=TRUE, message=FALSE, warning=FALSE}
ggplot(data=combined_hourly, aes(x=StepTotal, y=AverageIntensity)) + geom_point() + geom_smooth(method=lm) +
  labs(x="Steps", y="Average Intensity", title="Steps vs. Average Intensity")
```

* The higher the number of Steps taken, the higher the average Intensity value. 

## Weight Data

Loading the weight information file:

```{r}
WeightInfo <- read_csv("../input/fitbit/Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
```

Looking at the structure of the data:

```{r} 
str(WeightInfo)
```

No duplicates were found:

```{r}
nrow(WeightInfo[duplicated(WeightInfo), ])
```

Changing data type for variable Date (from character to date) by creating a new column:

```{r}
WeightInfo$Date_New <- mdy_hms(WeightInfo$Date)
```
 
We only have 8 respondents, making the sample size too small to draw any accurate conclusions.

```{r}
n_distinct(WeightInfo$Id)
```

Looking at data stats:

```{r}
Weight_Sum <- WeightInfo %>% group_by(Id) %>% 
  summarise(mean_WeightPounds=mean(WeightPounds), mean_BMI=mean(BMI))
  
summary(Weight_Sum)
```

```{r}
Weight_Sum <- transform(Weight_Sum, Category=if_else(mean_BMI>18.5 & mean_BMI<24.9,
    "Healthy Weight",(if_else(mean_BMI>25 & mean_BMI<29.9,"Overweight","Obese"))))

ggplot(Weight_Sum, aes(x=" ", y=" ", fill=Category)) + geom_bar(stat="identity", width=1) + 
    coord_polar(theta="y") + labs(x = " ", y = " ", title = "Users Average Weight") + 
    geom_text(stat="count", aes(y=after_stat(..count..), label=after_stat(scales::percent(..count../sum(..count..),1))), 
    position = position_stack(vjust = 0.4), size = 3, check_overlap= TRUE) +
    theme(legend.title=element_blank()) + theme_void()
```

5 (63%) users are overweight or obese. But this sample is too small to conclude anything regarding the population.

# CONCLUSIONS

## Data Limitations 

* Lack of demographic information is a challenge because the sample could be biased. This is especially important when considering that Bellabeat targets women. 

* Sample sizes are small, we start with 33 users but then this number decreases to 24 when we include sleep data. For weight we only have information for 8 users. For this reason, we can't draw solid conclusions from this data.

* Data is not recent (it was collected from April through May 2016), 7 years old as of the time this document was written.

* We found discrepancies in the data, for example: 1) Sedentary minutes seemed to have been overestimated; and 2) Some users recorded wearing the FitBit for more than 24 hours a day. These inaccuracies raise questions about the validity of the data.  

* FitBit and the Bellabeat watch have different features. They both have an app where people can track their stats, but the FitBit is a fitness band and a smartwatch while the Bellabeat tracker looks like a traditional watch. The Bellabeat customer seems to be more specific on the type of design she likes: a timeless classic watch with the hidden technology of a FitBit. 

* The FiBit tracking technology is proprietary and we don’t know their methodology to calculate activity intensities and aggregated values (e.g. minutes to hours). We assume Bellabeat uses a similar tracking technology.

## Recommendations

* The users in this sample seem to follow typical behaviors regarding Steps, Calories burned, Sleep and daily activity measured in time and distance. According to this sample, users seem to spend most of their time being sedentary, the steps they take are way below the recommended amount a day (10,000 steps) and most of the their distance is related to light or moderate activities. 

* The people in this group appear to be typical, but they see an opportunity for improving their overall health. The marketing message should emphasize that trackers play an important role in achieving healthy goals: Lose weight, improve sleep, and reduce stress. 

* Since the tracker appeals to people looking for a healthy lifestyle, the marketing message could include calls to action to start walking more, loose more calories and get better sleep. It'd be useful to remind users that trackers can send reminders during the day to help them achieve these goals.

* We'd like to have more reliable data on weight and sleep quality because these are key factors influencing why customers wear FitBits.

* We think users would like to see stress indicators and mindfulness features in the app. Ideally, we’d like to conclude that the more steps and exercise lead to a reduction in heart rate, and therefore to less stress. However, the available heart rate data is reported in seconds. We would need to have a methodology to aggregate the heart rate values to minutes or hours to be able to compare it to the other variables. 

* Per the information provided in this case study, we know that Bellabeat sells through their own e-commerce store focusing mainly on digital marketing. Better insights from consumers' behaviors and motivations would allow the digital marketing team to increase traffic and conversions using different channels such as: 

  + Pay-per-click: Finding keywords that customers are searching for on Google Search. Getting to bid on more specific and long-tail keywords to improve marketing costs.  

  + Social Media: Adding the right content to Bellabeat’s Facebook page and useful videos to Youtube, would inform customers that Bellabeat is all about healthy living, and an authority on smart devices and tracking technology.

  + Display Ads: The Google Display Network would be a great way to advertise on websites that have the right content and traffic.  Across the web there are plenty of opportunities to reach potential customers who are already reading about healthy living and looking for interesting content. 
